const fs = require('fs');
const config = require('../config');
const { cmd, commands } = require('../command');
const { runtime } = require('../lib/functions');
const axios = require('axios');

cmd({
    pattern: "menu",
    desc: "Show interactive menu system",
    category: "menu",
    react: "âš¡",
    filename: __filename
}, async (conn, mek, m, { from, reply }) => {
    try {
        // Count total commands
        const totalCommands = Object.keys(commands).length;
        
        // Your existing menu caption
        const menuCaption = `â•­â”â” âŒœ  *${config.BOT_NAME}* âŒŸ â”â”âŠ·â
â”ƒ ðŸ‘¤ Ê™á´á´› á´á´¡É´á´‡Ê€: *ðŒá´€Ò“Éªá´€ ð€á´…á´‡á´‡ÊŸ*
â”ƒ ðŸŒ á´á´á´…á´‡: *á´˜á´œÊ™ÊŸÉªá´„*
â”ƒ ðŸ”¤ á´˜Ê€á´‡Ò“Éªx: [ . ]
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”âŠ·â
â•­â”€ã€Œ *ðš˜ðš ðš—ðšŽðš›* ã€
â”‚ *á´á´€Ò“Éªá´€ á´€á´…á´‡á´‡ÊŸ*â¤ï¸â€ðŸ”¥
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·

ðŸ“œ *á´„Êœá´Éªá´„á´‡ á´„á´á´á´á´€É´á´…* 
â•­â”€ã€Œ *TOOá’ª Iá‘Žá–´O* ã€
â”‚ .*ðš–ðšŽðš—ðšž*
â”‚ .*ðš–ðšŽðš—ðšž2*
â”‚ .*ðšŠðš•ðš•ðš–ðšŽðš—ðšž*
â”‚ .*ðš•ðš’ðšœðšðš–ðšŽðš—ðšž*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á—ªOá—¯á‘Žá’ªOá—©á—ª á—°á—´á‘Žá‘Œ* ã€
â”‚ .*ðšðšŠðšŒðš‹ðš˜ðš˜ðš• (ðšžðš›ðš•)*
â”‚ .*ðšðš˜ðš ðš—ðš•ðš˜ðšŠðš (ðšžðš›ðš•)*
â”‚ .*ðš–ðšŽðšðš’ðšŠðšðš’ðš›ðšŽ (ðšžðš›ðš•)*
â”‚ .*ðšðš’ðš”ðšðš˜ðš” (ðšžðš›ðš•)*
â”‚ .*ðšðš ðš’ðšðšðšŽðš› (ðšžðš›ðš•)*
â”‚ .*ðš’ðš—ðšðšŠ (ðšžðš›ðš•)*
â”‚ .*ðšŠðš™ðš” (ðšŠðš™ðš™)*
â”‚ .*ðš’ðš–ðš (ðššðšžðšŽðš›ðš¢)*
â”‚ .*ðšðš2 (ðšžðš›ðš•)*
â”‚ .*ðš™ðš’ðš—ðšœ (ðšžðš›ðš•)*
â”‚ .*ðš™ðš’ðš—ðšðšŽðš›ðšŽðšœðš (ðšžðš›ðš•)*
â”‚ .*ðšŠðš™ðš”2 (ðšŠðš™ðš™)*
â”‚ .*ðšœðš™ðš˜ðšðš’ðšðš¢ (ðššðšžðšŽðš›ðš¢)*
â”‚ .*ðš™ðš•ðšŠðš¢ (ðšœðš˜ðš—ðš)*
â”‚ .*ðš™ðš•ðšŠðš¢2-10 (ðšžðš›ðš•)*
â”‚ .*ðšŠðšžðšðš’ðš˜ (ðšžðš›ðš•)*
â”‚ .*ðšŸðš’ðšðšŽðš˜ (ðšžðš›ðš•)*
â”‚ .*ðšŸðš’ðšðšŽðš˜2-10 (ðšžðš›ðš•)*
â”‚ .*ðš¢ðšðš–ðš™3 (ðšžðš›ðš•)*
â”‚ .*ðš¢ðšðš–ðš™4 (ðšžðš›ðš•)*
â”‚ .*ðšœðš’ðš—ðš (ðš—ðšŠðš–ðšŽ)*
â”‚ .*ðšðšŠðš›ðšŠðš–ðšŠ (ðš—ðšŠðš–ðšŽ)*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *TOOá’ª Iá‘Žá–´O* ã€
â”‚ .*ðšðš“ðš’ðš*
â”‚ .*ðš“ðš’ðš*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á—·OT Iá‘Žá–´O* ã€
â”‚ .*ðš™ðš’ðš—ðš*
â”‚ .*ðšŠðš•ðš’ðšŸðšŽ*
â”‚ .*ðš•ðš’ðšŸðšŽ*
â”‚ .*ðš˜ðš ðš—ðšŽðš›*
â”‚ .*ðš›ðšžðš—ðšðš’ðš–ðšŽ*
â”‚ .*ðšžðš™ðšðš’ðš–ðšŽ*
â”‚ .*ðš›ðšŽðš™ðš˜*
â”‚ .*ðš˜ðš ðš—ðšŽðš›*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á˜œá–‡Oá‘Œá‘­ á‘•Oá—°á—°á—©á‘Žá—ª* ã€
â”‚ .*ðšðš›ðš˜ðšžðš™ðš•ðš’ðš—ðš”*
â”‚ .*ðš”ðš’ðšŒðš”ðšŠðš•ðš•*
â”‚ .*ðš”ðš’ðšŒðš”ðšŠðš•ðš•2*
â”‚ .*ðš”ðš’ðšŒðš”ðšŠðš•ðš•3*
â”‚ .ðšŠðšðš +92Ã—Ã—*
â”‚ .*ðšðšŽðš–ðš˜ðšŸðšŽ @ðšžðšœðšŽðš›*
â”‚ .*ðš”ðš’ðšŒðš” @ðšžðšœðšŽðš›*
â”‚ .*ðš™ðšŽðš˜ðš–ðš˜ðšðšŽ @ðšžðšœðšŽðš›*
â”‚ .*ðšðšŽðš–ðš˜ðšðšŽ @ðšžðšœðšŽðš›*
â”‚ .*ðšðš’ðšœðš–ðš’ðšœðšœ*
â”‚ .*ðš›ðšŽðšŸðš˜ðš”ðšŽ*
â”‚ .*ðš–ðšžðšðšŽ (ðšðš’ðš–ðšŽ)*
â”‚ .*ðšžðš—ðš–ðšžðšðšŽ*
â”‚ .*ðš•ðš˜ðšŒðš”ðšðšŒ*
â”‚ .*ðšžðš—ðš•ðš˜ðšŒðš”ðšðšŒ*
â”‚ .*ðšðšŠðš @ðšžðšœðšŽðš›*
â”‚ .*ðš‘ðš’ðšðšŽðšðšŠðš (ðš–ðšœðš)*
â”‚ .*ðšðšŠðšðšŠðš•ðš•*
â”‚ .*ðšðšŠðšðšŠðšðš–ðš’*
â”‚ .*ðš’ðš—ðšŸðš’ðšðšŽ*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *SEARCH* ã€
â”‚ .*ðšðšŽðšðš’ðš—ðšŽ (ðš ðš˜ðš›ðš)*
â”‚ .*ðš—ðšŽðš ðšœ (ðššðšžðšŽðš›ðš¢)*
â”‚ .*ðš–ðš˜ðšŸðš’ðšŽ (ðš—ðšŠðš–ðšŽ)*
â”‚ .*ðš ðšŽðšŠðšðš‘ðšŽðš› (ðš•ðš˜ðšŒ)*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á—©I á–´á–‡á—´á—´* ã€
â”‚ .*ðšŠðš’*
â”‚ .*ðšŒðš‘ðšŠðšðšŠðš’*
â”‚ .*ðšðš™ðš*
â”‚ .*ðšðš™ðš2
â”‚ .*ðšðš™ðš3*
â”‚ .*ðšðš™ðšðš–ðš’ðš—ðš’*
â”‚ .*ðš–ðšŽðšðšŽ*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á–´á‘Œá‘Žá‘ŽY* ã€
â”‚ .*ðš‹ðšžðš•ðš•ðš¢ @ðšžðšœðšŽðš›*
â”‚ .*ðš‹ðš˜ðš—ðš” @ðšžðšœðšŽðš›*
â”‚ .*ðš¢ðšŽðšŽðš @ðšžðšœðšŽðš›*
â”‚ .*ðšœðš•ðšŠðš™ @ðšžðšœðšŽðš›*
â”‚ .*ðš”ðš’ðš•ðš• @ðšžðšœðšŽðš›*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á—©á–´á–´á—´á‘•TIOá‘Ž* ã€
â”‚ .*ðšŒðšžðšðšðš•ðšŽ @ðšžðšœðšŽðš›*
â”‚ .*ðš‘ðšžðš @ðšžðšœðšŽðš›*
â”‚ .*ðš”ðš’ðšœðšœ @ðšžðšœðšŽðš›*
â”‚ .*ðš”ðš’ðšŒðš” @ðšžðšœðšŽðš›*
â”‚ .*ðš™ðšŠðš @ðšžðšœðšŽðš›*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á—´á™­á‘­á–‡á—´ÕÕIOá‘ŽÕ* ã€
â”‚ .*ðš‹ðš•ðšžðšœðš‘ @ðšžðšœðšŽðš›*
â”‚ .*ðšœðš–ðš’ðš•ðšŽ @ðšžðšœðšŽðš›*
â”‚ .*ðš‘ðšŠðš™ðš™ðš¢ @ðšžðšœðšŽðš›*
â”‚ .*ðš ðš’ðš—ðš” @ðšžðšœðšŽðš›*
â”‚ .*ðš™ðš˜ðš”ðšŽ @ðšžðšœðšŽðš›*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á–‡á—´á‘Žá—ªOá—°* ã€
â”‚ .*ðšðš•ðš’ðš™*
â”‚ .*ðšŒðš˜ðš’ðš—ðšðš•ðš’ðš™*
â”‚ .*ðš›ðšŒðš˜ðš•ðš˜ðš›*
â”‚ .*ðš›ðš˜ðš•ðš•*
â”‚ .*ðšðšŠðšŒðš*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *OTá•¼á—´á–‡ á—°á—´á‘Žá‘Œ* ã€
â”‚ .*ðšðš’ðš–ðšŽðš—ðš˜ðš *
â”‚ .*ðšðšŠðšðšŽ*
â”‚ .*ðšŒðš˜ðšžðš—ðš (ðš—ðšžðš–)*
â”‚ .*ðšŒðšŠðš•ðšŒðšžðš•ðšŠðšðšŽ (ðšŽðš¡ðš™ðš›)*
â”‚ .*ðšŒðš˜ðšžðš—ðšðš¡*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *Tá—´á™­T TOOá’ª* ã€
â”‚ .*ðšðšŠðš—ðšŒðš¢ (ðšðšŽðš¡ðš)*
â”‚ .*ðšðšðšœ (ðšðšŽðš¡ðš)*
â”‚ .*ðšðš›ðš (ðšðšŽðš¡ðš)*
â”‚ .*ðš‹ðšŠðšœðšŽ64 (ðšðšŽðš¡ðš)*
â”‚ .*ðšžðš—ðš‹ðšŠðšœðšŽ64 (ðšðšŽðš¡ðš)*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á‘•Oá‘Žá¯á—´á–‡T á—°á—´á‘Žá‘Œ* ã€
â”‚ .*ðš–ðšŽðšðš’ðšŠ ðšŒðš˜ðš—ðšŸðšŽðš›ðšœðš’ðš˜ðš—*
â”‚ .*ðšœðšðš’ðšŒðš”ðšŽðš› (ðš’ðš–ðš)*
â”‚ .*ðšœðšðš’ðšŒðš”ðšŽðš›2 (ðš’ðš–ðš)*
â”‚ .*ðšŽðš–ðš˜ðš“ðš’ðš–ðš’ðš¡ ðŸ¥°+ðŸ¥µ*
â”‚ .*ðšðšŠðš”ðšŽ (ðš—ðšŠðš–ðšŽ,ðšðšŽðš¡ðš)*
â”‚ .*ðšðš˜ðš–ðš™3 (ðšŸðš’ðšðšŽðš˜)*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á‘•á•¼á—©á–‡á—©á‘•Tá—´á–‡Õ á—°á—´á‘Žá‘Œ* ã€
â”‚ .*ðšŠðš—ðš’ðš–ðšŽðšðš’ðš›ðš•*
â”‚ .*ðšŠðš—ðš’ðš–ðšŽðšðš’ðš›ðš•ðš•-5*
â”‚ .*ðšŠðš—ðš’ðš–ðšŽ-5*
â”‚ .*ðšðš˜ðš¡ðšðš’ðš›ðš•*
â”‚ .*ðš—ðšŠðš›ðšžðšðš˜*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á—©á‘ŽIá—°á—´ á—°á—´á‘Žá‘Œ* ã€
â”‚ .*ðš’ðš–ðšŠðšðšŽðšœ*
â”‚ .*ðšðšŠðšŒðš”*
â”‚ .*ðšðš˜ðš*
â”‚ .*ðšŠðš ðš˜ðš˜*
â”‚ .*ðšðšŠðš›ðš•*
â”‚ .*ðš ðšŠðš’ðšðšž*
â”‚ .*ðš—ðšŽðš”ðš˜*
â”‚ .*ðš–ðšŽðšðš—ðšžðš–ðš’ðš—*
â”‚ .*ðš–ðšŠðš’ðš*
â”‚ .*ðšŠðš—ðš’ðš–ðšŽðšðš’ðš›ðš•*
â”‚ .*ðš•ðš˜ðš•ðš˜*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *Iá—°á˜œ á—°á—´á‘Žá‘Œ* ã€
â”‚ .*ðš’ðš–ðšŠðšðšŽ*
â”‚ .*ðš’ðš–ðšŠðšðš’ðš—ðšŽ1 (ðšðšŽðš¡ðš)*
â”‚ .*ðš’ðš–ðšŠðšðš’ðš—ðšŽ2 (ðšðšŽðš¡ðš)*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *Õá‘­á—´á‘•Iá—©á’ªIá˜”á—´á—ª* ã€
â”‚ .*ðš‹ðš•ðšŠðšŒðš”ðš‹ðš˜ðš¡ (ðššðšžðšŽðš›ðš¢)*
â”‚ .*ðš•ðšžðš–ðšŠ (ðššðšžðšŽðš›ðš¢)*
â”‚ .*ðšðš“ (ðššðšžðšŽðš›ðš¢)*
â”‚ .*ðšŠðšðšŽðšŽðš• (ðššðšžðšŽðš›ðš¢)*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á‘ŒÕá—´á–‡ á—°á—´á‘Žá‘Œ* ã€
â”‚ .*ðš›ðšŽðšœðšðš›ðš’ðšŒðšðšŽðš ðšŒðš˜ðš–ðš–ðšŠðš—ðšðšœ*
â”‚ .*ðš‹ðš•ðš˜ðšŒðš”*
â”‚ .*ðšžðš—ðš‹ðš•ðš˜ðšŒðš”*
â”‚ .*ðšðšžðš•ðš•ðš™ðš™*
â”‚ .*ðšœðšŽðšðš™ðš™*
â”‚ .*ðš›ðšŽðšœðšðšŠðš›ðš*
â”‚ .*ðšœðš‘ðšžðšðšðš˜ðš ðš—*
â”‚ .*ðšžðš—ðšðšŠðšðšŽðšŒðš–ðš*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á–‡á—´á—©á‘•T á—°á—´á‘Žá‘Œ* ã€
â”‚ .*ðš•ðš˜ðšŸðšŽ*
â”‚ .*ðš‘ðšŠðš™ðš™ðš¢*
â”‚ .*ðšœðšŠðš*
â”‚ .*ðš‘ðš˜ðš*
â”‚ .*ðš‘ðšŽðšŠðš›ðš*
â”‚ .*ðšœðš‘ðš¢*
â”‚ .*ðš‹ðšŽðšŠðšžðšðš’ðšðšžðš•*
â”‚ .*ðšŒðšžðš—ðšðšžðšœðšŽðš*
â”‚ .*ðš–ðš˜ðš—*
â”‚ .*ðš”ðš’ðšœðšœ*
â”‚ .*ðš‹ðš›ðš˜ðš”ðšŽ*
â”‚ .*ðš‘ðšžðš›ðš*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *Iá‘ŽTá—´á–‡á—©á‘•TIá¯á—´ á—°á—´á‘Žá‘Œ* ã€
â”‚ .*ðšœðš‘ðšŠðš™ðšŽðš›*
â”‚ .*ðš›ðšŠðšðšŽ @ðšžðšœðšŽðš›*
â”‚ .*ðš’ðš—ðšœðšžðš•ðš @ðšžðšœðšŽðš›*
â”‚ .*ðš‘ðšŠðšŒðš” @ðšžðšœðšŽðš›*
â”‚ .*ðšœðš‘ðš’ðš™ @ðšžðšœðšŽðš›1 @ðšžðšœðšŽðš›2*
â”‚ .*ðšŒðš‘ðšŠðš›ðšŠðšŒðšðšŽðš›*
â”‚ .*ðš™ðš’ðšŒðš”ðšžðš™*
â”‚ .*ðš“ðš˜ðš”ðšŽ*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á‘­á—©Ká—©á˜œá—´* ã€
â”‚ .*ðš—ðš™ðš–*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *á‘Œá‘­á—ªá—©Tá—´* ã€
â”‚ .*ðšžðš™ðšðšŠðšðšŽ*
â”‚ .*ðš›ðšŽðšœðšðšŠðš›ðš*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
â•­â”€ã€Œ *KIá‘Žá˜œðŸ”¥* ã€
â”‚ *á—°á—©á–´Iá—© á—©á—ªá—´á—´á’ªâ¤ï¸â€ðŸ”¥*
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€âŠ·
> ${config.DESCRIPTION}`;

        const contextInfo = {
            mentionedJid: [m.sender],
            forwardingScore: 999,
            isForwarded: true,
            forwardedNewsletterMessageInfo: {
                newsletterJid: '120363423571792427@newsletter',
                newsletterName: config.OWNER_NAME,
                serverMessageId: 143
            }
        };

        // Function to send menu image
        const sendMenuImage = async () => {
            try {
                return await conn.sendMessage(
                    from,
                    {
                        image: { url: config.MENU_IMAGE_URL || 'https://files.catbox.moe/ejufwa.jpg' },
                        caption: menuCaption,
                        contextInfo: contextInfo
                    },
                    { quoted: mek }
                );
            } catch (e) {
                console.log('Image send failed, falling back to text');
                return await conn.sendMessage(
                    from,
                    { text: menuCaption, contextInfo: contextInfo },
                    { quoted: mek }
                );
            }
        };

        // Send image with timeout
        let sentMsg;
        try {
            sentMsg = await Promise.race([
                sendMenuImage(),
                new Promise((_, reject) => setTimeout(() => reject(new Error('Image send timeout')), 10000))
            ]);
        } catch (e) {
            console.log('Menu send error:', e);
            sentMsg = await conn.sendMessage(
                from,
                { text: menuCaption, contextInfo: contextInfo },
                { quoted: mek }
            );
        }
        
        const messageID = sentMsg.key.id;

        // Menu data (complete version)
        const menuData = {
            '1': {
                title: "ðŸ“¥ *Download Menu* ðŸ“¥",
                content: `â•­â”â”â”ã€” *Download Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸŒ *Social Media*
â”ƒâ˜…â”‚ â€¢ facebook [url]
â”ƒâ˜…â”‚ â€¢ mediafire [url]
â”ƒâ˜…â”‚ â€¢ tiktok [url]
â”ƒâ˜…â”‚ â€¢ twitter [url]
â”ƒâ˜…â”‚ â€¢ Insta [url]
â”ƒâ˜…â”‚ â€¢ apk [app]
â”ƒâ˜…â”‚ â€¢ img [query]
â”ƒâ˜…â”‚ â€¢ tt2 [url]
â”ƒâ˜…â”‚ â€¢ pins [url]
â”ƒâ˜…â”‚ â€¢ apk2 [app]
â”ƒâ˜…â”‚ â€¢ fb2 [url]
â”ƒâ˜…â”‚ â€¢ pinterest [url]
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸŽµ *Music/Video*
â”ƒâ˜…â”‚ â€¢ spotify [query]
â”ƒâ˜…â”‚ â€¢ play [song]
â”ƒâ˜…â”‚ â€¢ play2-10 [song]
â”ƒâ˜…â”‚ â€¢ audio [url]
â”ƒâ˜…â”‚ â€¢ video [url]
â”ƒâ˜…â”‚ â€¢ video2-10 [url]
â”ƒâ˜…â”‚ â€¢ ytmp3 [url]
â”ƒâ˜…â”‚ â€¢ ytmp4 [url]
â”ƒâ˜…â”‚ â€¢ song [name]
â”ƒâ˜…â”‚ â€¢ darama [name]
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '2': {
                title: "ðŸ‘¥ *Group Menu* ðŸ‘¥",
                content: `â•­â”â”â”ã€” *Group Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ› ï¸ *Management*
â”ƒâ˜…â”‚ â€¢ grouplink
â”ƒâ˜…â”‚ â€¢ kickall
â”ƒâ˜…â”‚ â€¢ kickall2
â”ƒâ˜…â”‚ â€¢ kickall3
â”ƒâ˜…â”‚ â€¢ add @user
â”ƒâ˜…â”‚ â€¢ remove @user
â”ƒâ˜…â”‚ â€¢ kick @user
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ âš¡ *Admin Tools*
â”ƒâ˜…â”‚ â€¢ promote @user
â”ƒâ˜…â”‚ â€¢ demote @user
â”ƒâ˜…â”‚ â€¢ dismiss 
â”ƒâ˜…â”‚ â€¢ revoke
â”ƒâ˜…â”‚ â€¢ mute [time]
â”ƒâ˜…â”‚ â€¢ unmute
â”ƒâ˜…â”‚ â€¢ lockgc
â”ƒâ˜…â”‚ â€¢ unlockgc
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ·ï¸ *Tagging*
â”ƒâ˜…â”‚ â€¢ tag @user
â”ƒâ˜…â”‚ â€¢ hidetag [msg]
â”ƒâ˜…â”‚ â€¢ tagall
â”ƒâ˜…â”‚ â€¢ tagadmins
â”ƒâ˜…â”‚ â€¢ invite
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '3': {
                title: "ðŸ˜„ *Fun Menu* ðŸ˜„",
                content: `â•­â”â”â”ã€” *Fun Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸŽ­ *Interactive*
â”ƒâ˜…â”‚ â€¢ shapar
â”ƒâ˜…â”‚ â€¢ rate @user
â”ƒâ˜…â”‚ â€¢ insult @user
â”ƒâ˜…â”‚ â€¢ hack @user
â”ƒâ˜…â”‚ â€¢ ship @user1 @user2
â”ƒâ˜…â”‚ â€¢ character
â”ƒâ˜…â”‚ â€¢ pickup
â”ƒâ˜…â”‚ â€¢ joke
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ˜‚ *Reactions*
â”ƒâ˜…â”‚ â€¢ hrt
â”ƒâ˜…â”‚ â€¢ hpy
â”ƒâ˜…â”‚ â€¢ syd
â”ƒâ˜…â”‚ â€¢ anger
â”ƒâ˜…â”‚ â€¢ shy
â”ƒâ˜…â”‚ â€¢ kiss
â”ƒâ˜…â”‚ â€¢ mon
â”ƒâ˜…â”‚ â€¢ cunfuzed
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '4': {
                title: "ðŸ‘‘ *Owner Menu* ðŸ‘‘",
                content: `â•­â”â”â”ã€” *Owner Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ âš ï¸ *Restricted*
â”ƒâ˜…â”‚ â€¢ block @user
â”ƒâ˜…â”‚ â€¢ unblock @user
â”ƒâ˜…â”‚ â€¢ fullpp [img]
â”ƒâ˜…â”‚ â€¢ setpp [img]
â”ƒâ˜…â”‚ â€¢ restart
â”ƒâ˜…â”‚ â€¢ shutdown
â”ƒâ˜…â”‚ â€¢ updatecmd
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ â„¹ï¸ *Info Tools*
â”ƒâ˜…â”‚ â€¢ gjid
â”ƒâ˜…â”‚ â€¢ jid @user
â”ƒâ˜…â”‚ â€¢ listcmd
â”ƒâ˜…â”‚ â€¢ allmenu
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '5': {
                title: "ðŸ¤– *AI Menu* ðŸ¤–",
                content: `â•­â”â”â”ã€” *AI Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ’¬ *Chat AI*
â”ƒâ˜…â”‚ â€¢ ai [query]
â”ƒâ˜…â”‚ â€¢ gpt3 [query]
â”ƒâ˜…â”‚ â€¢ gpt2 [query]
â”ƒâ˜…â”‚ â€¢ gptmini [query]
â”ƒâ˜…â”‚ â€¢ gpt [query]
â”ƒâ˜…â”‚ â€¢ meta [query]
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ–¼ï¸ *Image AI*
â”ƒâ˜…â”‚ â€¢ imagine [text]
â”ƒâ˜…â”‚ â€¢ imagine2 [text]
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ” *Specialized*
â”ƒâ˜…â”‚ â€¢ blackbox [query]
â”ƒâ˜…â”‚ â€¢ luma [query]
â”ƒâ˜…â”‚ â€¢ dj [query]
â”ƒâ˜…â”‚ â€¢ khan [query]
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '6': {
                title: "ðŸŽŽ *Anime Menu* ðŸŽŽ",
                content: `â•­â”â”â”ã€” *Anime Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ–¼ï¸ *Images*
â”ƒâ˜…â”‚ â€¢ fack
â”ƒâ˜…â”‚ â€¢ dog
â”ƒâ˜…â”‚ â€¢ awoo
â”ƒâ˜…â”‚ â€¢ garl
â”ƒâ˜…â”‚ â€¢ waifu
â”ƒâ˜…â”‚ â€¢ neko
â”ƒâ˜…â”‚ â€¢ megnumin
â”ƒâ˜…â”‚ â€¢ maid
â”ƒâ˜…â”‚ â€¢ loli
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸŽ­ *Characters*
â”ƒâ˜…â”‚ â€¢ animegirl
â”ƒâ˜…â”‚ â€¢ animegirl1-5
â”ƒâ˜…â”‚ â€¢ anime1-5
â”ƒâ˜…â”‚ â€¢ foxgirl
â”ƒâ˜…â”‚ â€¢ naruto
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '7': {
                title: "ðŸ”„ *Convert Menu* ðŸ”„",
                content: `â•­â”â”â”ã€” *Convert Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ–¼ï¸ *Media*
â”ƒâ˜…â”‚ â€¢ sticker [img]
â”ƒâ˜…â”‚ â€¢ sticker2 [img]
â”ƒâ˜…â”‚ â€¢ emojimix ðŸ˜Ž+ðŸ˜‚
â”ƒâ˜…â”‚ â€¢ take [name,text]
â”ƒâ˜…â”‚ â€¢ tomp3 [video]
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ“ *Text*
â”ƒâ˜…â”‚ â€¢ fancy [text]
â”ƒâ˜…â”‚ â€¢ tts [text]
â”ƒâ˜…â”‚ â€¢ trt [text]
â”ƒâ˜…â”‚ â€¢ base64 [text]
â”ƒâ˜…â”‚ â€¢ unbase64 [text]
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '8': {
                title: "ðŸ“Œ *Other Menu* ðŸ“Œ",
                content: `â•­â”â”â”ã€” *Other Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ•’ *Utilities*
â”ƒâ˜…â”‚ â€¢ timenow
â”ƒâ˜…â”‚ â€¢ date
â”ƒâ˜…â”‚ â€¢ count [num]
â”ƒâ˜…â”‚ â€¢ calculate [expr]
â”ƒâ˜…â”‚ â€¢ countx
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸŽ² *Random*
â”ƒâ˜…â”‚ â€¢ flip
â”ƒâ˜…â”‚ â€¢ coinflip
â”ƒâ˜…â”‚ â€¢ rcolor
â”ƒâ˜…â”‚ â€¢ roll
â”ƒâ˜…â”‚ â€¢ fact
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ” *Search*
â”ƒâ˜…â”‚ â€¢ define [word]
â”ƒâ˜…â”‚ â€¢ news [query]
â”ƒâ˜…â”‚ â€¢ movie [name]
â”ƒâ˜…â”‚ â€¢ weather [loc]
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '9': {
                title: "ðŸ’ž *Reactions Menu* ðŸ’ž",
                content: `â•­â”â”â”ã€” *Reactions Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ â¤ï¸ *Affection*
â”ƒâ˜…â”‚ â€¢ cuddle @user
â”ƒâ˜…â”‚ â€¢ hug @user
â”ƒâ˜…â”‚ â€¢ kiss @user
â”ƒâ˜…â”‚ â€¢ lick @user
â”ƒâ˜…â”‚ â€¢ pat @user
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ˜‚ *Funny*
â”ƒâ˜…â”‚ â€¢ bully @user
â”ƒâ˜…â”‚ â€¢ bonk @user
â”ƒâ˜…â”‚ â€¢ yeet @user
â”ƒâ˜…â”‚ â€¢ slap @user
â”ƒâ˜…â”‚ â€¢ kill @user
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ˜Š *Expressions*
â”ƒâ˜…â”‚ â€¢ blush @user
â”ƒâ˜…â”‚ â€¢ smile @user
â”ƒâ˜…â”‚ â€¢ happy @user
â”ƒâ˜…â”‚ â€¢ wink @user
â”ƒâ˜…â”‚ â€¢ poke @user
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            },
            '10': {
                title: "ðŸ  *Main Menu* ðŸ ",
                content: `â•­â”â”â”ã€” *Main Menu* ã€•â”â”â”â”ˆâŠ·
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ â„¹ï¸ *Bot Info*
â”ƒâ˜…â”‚ â€¢ ping
â”ƒâ˜…â”‚ â€¢ live
â”ƒâ˜…â”‚ â€¢ alive
â”ƒâ˜…â”‚ â€¢ runtime
â”ƒâ˜…â”‚ â€¢ uptime
â”ƒâ˜…â”‚ â€¢ repo
â”ƒâ˜…â”‚ â€¢ owner
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”ƒâ˜…â”‚ ðŸ› ï¸ *Controls*
â”ƒâ˜…â”‚ â€¢ menu
â”ƒâ˜…â”‚ â€¢ menu2
â”ƒâ˜…â”‚ â€¢ restart
â”ƒâ˜…â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â•°â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”ˆâŠ·
> ${config.DESCRIPTION}`,
                image: true
            }
        };

        // Message handler with improved error handling
        const handler = async (msgData) => {
            try {
                const receivedMsg = msgData.messages[0];
                if (!receivedMsg?.message || !receivedMsg.key?.remoteJid) return;

                const isReplyToMenu = receivedMsg.message.extendedTextMessage?.contextInfo?.stanzaId === messageID;
                
                if (isReplyToMenu) {
                    const receivedText = receivedMsg.message.conversation || 
                                      receivedMsg.message.extendedTextMessage?.text;
                    const senderID = receivedMsg.key.remoteJid;

                    if (menuData[receivedText]) {
                        const selectedMenu = menuData[receivedText];
                        
                        try {
                            if (selectedMenu.image) {
                                await conn.sendMessage(
                                    senderID,
                                    {
                                        image: { url: config.MENU_IMAGE_URL || 'https://files.catbox.moe/ejufwa.jpg' },
                                        caption: selectedMenu.content,
                                        contextInfo: contextInfo
                                    },
                                    { quoted: receivedMsg }
                                );
                            } else {
                                await conn.sendMessage(
                                    senderID,
                                    { text: selectedMenu.content, contextInfo: contextInfo },
                                    { quoted: receivedMsg }
                                );
                            }

                            await conn.sendMessage(senderID, {
                                react: { text: 'âœ…', key: receivedMsg.key }
                            });

                        } catch (e) {
                            console.log('Menu reply error:', e);
                            await conn.sendMessage(
                                senderID,
                                { text: selectedMenu.content, contextInfo: contextInfo },
                                { quoted: receivedMsg }
                            );
                        }

                    } else {
                        await conn.sendMessage(
                            senderID,
                            {
                                text: `âŒ *Invalid Option!* âŒ\n\nPlease reply with a number between 1-10 to select a menu.\n\n*Example:* Reply with "1" for Download Menu\n\n> ${config.DESCRIPTION}`,
                                contextInfo: contextInfo
                            },
                            { quoted: receivedMsg }
                        );
                    }
                }
            } catch (e) {
                console.log('Handler error:', e);
            }
        };

        // Add listener
        conn.ev.on("messages.upsert", handler);

        // Remove listener after 5 minutes
        setTimeout(() => {
            conn.ev.off("messages.upsert", handler);
        }, 300000);

    } catch (e) {
        console.error('Menu Error:', e);
        try {
            await conn.sendMessage(
                from,
                { text: `âŒ Menu system is currently busy. Please try again later.\n\n> ${config.DESCRIPTION}` },
                { quoted: mek }
            );
        } catch (finalError) {
            console.log('Final error handling failed:', finalError);
        }
    }
});
